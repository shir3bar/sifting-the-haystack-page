<script src="http://www.google.com/jsapi" type="text/javascript"></script> 
<script type="text/javascript">google.load("jquery", "1.3.2");</script>

<style type="text/css">
	body {
		font-family: "HelveticaNeue-Light", "Helvetica Neue Light", "Helvetica Neue", Helvetica, Arial, "Lucida Grande", sans-serif; 
		font-weight:300;
		font-size:18px;
		margin-left: auto;
		margin-right: auto;
		width: 1100px;
	}
	
	h1 {
		font-size:32px;
		font-weight:300;
	}
	
	.disclaimerbox {
		background-color: #eee;		
		border: 1px solid #eeeeee;
		border-radius: 10px ;
		-moz-border-radius: 10px ;
		-webkit-border-radius: 10px ;
		padding: 20px;
	}

	video.header-vid {
		height: 140px;
		border: 1px solid black;
		border-radius: 10px ;
		-moz-border-radius: 10px ;
		-webkit-border-radius: 10px ;
	}
	
	img.header-img {
		height: 140px;
		border: 1px solid black;
		border-radius: 10px ;
		-moz-border-radius: 10px ;
		-webkit-border-radius: 10px ;
	}
	
	img.rounded {
		border: 1px solid #eeeeee;
		border-radius: 10px ;
		-moz-border-radius: 10px ;
		-webkit-border-radius: 10px ;
	}
	
	a:link,a:visited
	{
		color: #1367a7;
		text-decoration: none;
	}
	a:hover {
		color: #208799;
	}
	
	td.dl-link {
		height: 160px;
		text-align: center;
		font-size: 22px;
	}
	
	.layered-paper-big { /* modified from: http://css-tricks.com/snippets/css/layered-paper/ */
		box-shadow:
		0px 0px 1px 1px rgba(0,0,0,0.35), /* The top layer shadow */
		5px 5px 0 0px #fff, /* The second layer */
		5px 5px 1px 1px rgba(0,0,0,0.35), /* The second layer shadow */
		10px 10px 0 0px #fff, /* The third layer */
		10px 10px 1px 1px rgba(0,0,0,0.35), /* The third layer shadow */
		15px 15px 0 0px #fff, /* The fourth layer */
		15px 15px 1px 1px rgba(0,0,0,0.35), /* The fourth layer shadow */
		20px 20px 0 0px #fff, /* The fifth layer */
		20px 20px 1px 1px rgba(0,0,0,0.35), /* The fifth layer shadow */
		25px 25px 0 0px #fff, /* The fifth layer */
		25px 25px 1px 1px rgba(0,0,0,0.35); /* The fifth layer shadow */
		margin-left: 10px;
		margin-right: 45px;
	}

	.paper-big { /* modified from: http://css-tricks.com/snippets/css/layered-paper/ */
		box-shadow:
		0px 0px 1px 1px rgba(0,0,0,0.35); /* The top layer shadow */

		margin-left: 10px;
		margin-right: 45px;
	}


	.layered-paper { /* modified from: http://css-tricks.com/snippets/css/layered-paper/ */
		box-shadow:
		0px 0px 1px 1px rgba(0,0,0,0.35), /* The top layer shadow */
		5px 5px 0 0px #fff, /* The second layer */
		5px 5px 1px 1px rgba(0,0,0,0.35), /* The second layer shadow */
		10px 10px 0 0px #fff, /* The third layer */
		10px 10px 1px 1px rgba(0,0,0,0.35); /* The third layer shadow */
		margin-top: 5px;
		margin-left: 10px;
		margin-right: 30px;
		margin-bottom: 5px;
	}
	
	.vert-cent {
		position: relative;
		top: 50%;
		transform: translateY(-50%);
	}
	
	hr
	{
		border: 0;
		height: 1px;
		background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0));
	}
</style>

<html>
<head>
	<title>Sifting through the haystack - efficiently finding rare animal behaviors in large-scale datasets [WACV2025]</title>
	<meta property="og:image" content="Path to my teaser.png"/> <!-- Facebook automatically scrapes this. Go to https://developers.facebook.com/tools/debug/ if you update and want to force Facebook to rescrape. -->
	<meta property="og:title" content="Sifting through the haystack - efficiently finding rare animal behaviors in large-scale datasets" />
	<meta property="og:description" content="We propose an anomaly detection based pipeline to detect rare animal behaviors." />

	<!-- Get from Google Analytics -->
	<!-- Global site tag (gtag.js) - Google Analytics -->
	<script async src=""></script> 
	<script>
		window.dataLayer = window.dataLayer || [];
		function gtag(){dataLayer.push(arguments);}
		gtag('js', new Date());

		gtag('config', 'UA-75863369-6');
	</script>
</head>

<body>
	<br>
	<center>
		<span style="font-size:32px">Sifting through the haystack - efficiently finding rare animal behaviors in large-scale datasets [WACV2025]</span>
		<table align=center width=600px>
			<table align=center width=600px>
				<tr>
					<td align=center width=100px>
						<center>
							<span style="font-size:24px"><a href="https://github.com/shir3bar/">Shir Bar</a></span>
						</center>
					</td>
					<td align=center width=100px>
						<center>
							<span style="font-size:24px"><a href="https://github.com/orhir/">Or Hirschorn</a></span>
						</center>
					</td>
					<td align=center width=100px>
						<center>
							<span style="font-size:24px"><a href="http://iui-eilat.ac.il/People/AcademicStaffProfile.aspx?sid=106">Roi Holzman</a></span>
						</center>
					</td>
					<td align=center width=100px>
						<center>
							<span style="font-size:24px"><a href="http://www.eng.tau.ac.il/~avidan/">Shai Avidan</a></span>
						</center>
					</td>
				</tr>
			</table>
			<hr>
			<table align=center width=250px>
				<tr>
					<td align=center width=120px>
						<center>
							<span style="font-size:24px"><a href='https://doi.org/10.48550/arXiv.2412.03452'>[Paper]</a></span>
						</center>
					</td>
		<!--		<td align=center width=120px>
						<center>
							<span style="font-size:24px"><a href='./resources/poster.pdf'>[Poster]</a></span>
						</center>
					</td>-->	
					<td align=center width=120px>
						<center>
							<span style="font-size:24px"><a href='#Data'>[Data]</a></span>
						</center>
					</td>
					<td align=center width=120px>
						<center>
							<span style="font-size:24px"><a href='https://github.com/shir3bar/SiftingTheHaystack'>[GitHub]</a></span><br>
						</center>
					</td>
				</tr>
			</table>
		</table>
	</center>
<br>
	<center>
		<table align=center width=850px>
			<tr>
				<td width=850px>
					<center>
						<img class="round" style="width:850px" src="./resources/problemsetup_final_aligned.png"/>
					</center>
				</td>
			</tr>
		</table>
	<table align=center width=850px>
			<tr>
				<td>
					<span style="font-size:14px"><center>Problem setup</center></span>

				</td>
			</tr>
		</table>
	</center>

	<hr>

	<table align=center width=850px>
		<center><h1>Abstract</h1></center>
		<tr>
			<td>
				In the study of animal behavior, researchers often record long continuous videos, accumulating into large-scale datasets. 
				However, the behaviors of interest are often rare compared to routine behaviors. 
				This incurs a heavy cost on manual annotation, forcing users to sift through many samples before finding their needles. 
				We propose a pipeline to efficiently sample rare behaviors from large datasets, enabling the creation of training datasets for rare behavior classifiers. 
				Our method only needs an unlabeled animal pose or acceleration dataset as input and makes no assumptions regarding the type, number, or characteristics of the rare behaviors.
				<br>
				Our pipeline is based on a recent graph-based anomaly detection model for human behavior, which we apply to this new data domain. 
				It leverages anomaly scores to automatically label normal samples while directing human annotation efforts toward anomalies.
				In research data, anomalies may come from many different sources (e.g., signal noise versus true rare instances).
				Hence, the entire labeling budget is focused on the abnormal classes, letting the user review and label samples according to their needs. 
				<br>
				We tested our approach on three datasets of freely-moving animals, acquired in the laboratory and the field.
				We found that graph-based models are particularly useful when studying motion-based behaviors in animals, 
				yielding good results while using a small labeling budget.
				Our method consistently outperformed traditional random sampling, 
				offering an average improvement of 70% in performance and creating datasets even when the behavior of interest was only 0.02% of the data. 
				Even when the performance gain was minor (e.g., when the behavior is not rare), our method still reduced the annotation effort by half.
			</td>
		</tr>
	</table>
	<br>

	<hr>
	<center><h1>Pipeline overview</h1></center>
	<!-- <p align="center">
		<iframe width="660" height="395" src="https://www.youtube.com/embed/dQw4w9WgXcQ" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen align="center"></iframe>
	</p> -->
	<table align=center width=800px>
		<tr>
			<td align=center width=800px>
				<center>
					<td><img class="round" style="width:800px" src="./resources/overview.png"/></td>
				</center>
			</td>
		</tr>
	</table>
	<table align=center width=850px>
			<tr>
				<center>
				<td align=center>
					<span style="font-size:14px">An overview of our workflow.</span>
				</td>
				</center>
			</tr>
		</table>
	<!-- <table align=center width=800px>
		<br>
		<tr>
			<center>
				<span style="font-size:28px"><a href=''>[Slides]</a>
				</span>
			</center>
		</tr>
	</table>-->
	<br>
	<table align=center width=850px>
		<center>
			<tr>
				<td>
					Our pipeline is designed to scan large-scale datasets of animal behavior samples represented as either pose estimated clips or accelerometer measurements.
					We use first train a <a href="https://github.com/orhir/STG-NF">state-of-the-art anomaly detector</a> on the dataset, and then rank the dataset according to the resulting anomaly scores.
					We then create a training dataset for a classifier by sampling the resulting score distribution in two regions:
					<ol>
						<li><b>The tail of the distribution</b> - containing high scoring clips, gets manually reviewed by a human to find behaviors of interest. Samples of interest are labeled as "abnormal"/"rare" and normal samples are labeled as "normal"</li>
						<li><b>The center of the distribution</b> - containing the most "normal" clips, samples here do not get reviewed they just get pseudo-labeled as normal. </li>
					</ol>
					We then train a classifier on this labeled dataset and test it on a held-out test set.
				</td>
			</tr>
		</center>
	</table>
	<hr>
	<div id="Data">
	<center><h1>Data</h1></center>
	<table align=center width=800px>
		<tr>
			<td align=center width=800px>
				<center>
					<img src = "./resources/data_samples.png", width="450" />
				</center>
		  </td>
  </tr>
</table>


<table align=center width=850px>
  <tr>
	  <center>
		  <td align=center>
			  <span style="font-size:12px">Examples from each of the datasets - a) Synthetic - a 5-keypoint skeleton motion through time (lower opacity, earlier frame). b) FishLarvae1 - a fish larvae behavior clip through time (same as a), c) PoseR - a single representative frame from behavior clip, d) Meerkat - a tri-axial accelerometery sample through time (x-axis). </span>
		  </td>
	  </center>
  </tr>
</table>
<br>
	<table align=center width=850px>
		<center>
			<tr>
				<td>
					We test our pipeline using three published datasets sourced from experimental biology and ecology and a new synthetic dataset we created to emulate larval fish swimming behavior.
					<ol>
						<li>Fishlarvae1 - Published by <a href="https://doi.org/10.1016/j.cub.2019.11.026">Johnson et al. 2020</a> - pose estimated clips featuring larval fish prey hunting behavior in a large scale arena.</li>
						<li> PoseR - Released by <a href="https://doi.org/10.1101/2023.04.07.535991">Mullen et al. 2023</a> - pose estimated clips featuring larval fish behavior from a collection of neurological assays</li>
						<li>Meerkat - Published by <a href='https://doi.org/10.1111/2041-210X.13172'>Chakravarty et al. 2019 </a> - accelerometery samples featuring freely behaving meerkats in the wild.</li>
						<li> Synthetic - we simulated pose estimated larval fish behaviors using two simple kinematic parameters, by controlling their variation we create dataset with varying similarity between behaviors and test the efficacy of our pipeline in a controlled manner.</li>
					</ol>
				</td>
			</tr>
		</center>
	</table>


	<table align=center width=800px>
		<br>
		<tr>
			<td align=center width=120px>
				<center>
					<span style="font-size:24px"><a href='https://github.com/shir3bar/SiftingTheHaystack/tree/main/data_prep'>[Data preparation code]</a></span>
				</center>
			</td>
			<td align=center width=120px>
				<center>
					<span style="font-size:24px"><a href='https://zenodo.org/records/14266407'>[Synthetic Dataset]</a></span>
				</center>
			</td>
			<td align=center width=120px>
				<center>
					<span style="font-size:24px"><a href='https://zenodo.org/records/14253658'>[Data for statistics]</a></span>
				</center>
			</td>
		</tr>
	</table>
	</div>
	<br>
	<hr>
	<div id="Performance">
	<center><h1>Performance evaluation</h1></center>

	<table align=center width=850px>
		<center>
			<tr>
				<td>
					We evaluate the performance of our pipeline using a set of rarity experiments where we artificially rarify the behavior of interest and test how well our pipeline does at detecting rare behaviors.
					Our evaluation metric is the area under the precision-recall curve (AuPRC) of the classifier trained on the labeled dataset our pipeline created.
					We find that our pipeline generally outperforms random sampling, and at worse being on par with random sampling. 
					Crucially, we find that the performance gain is more significant when the behavior of interest is rarer.
					We use a linear model to model the effect of sampling method, rarity, labeled dataset size on AuPRC. For the synthetic dataset we add the behavior similarity 
				</td>
			</tr>
		</center>
	</table>
	<center><h2>Synthetic dataset</h2></center>
	<table align=center width=800px>
		<tr>
			<td align=center width=800px>
				<center>
					<td><img class="round" style="width:800px" src="./resources/Fig5.png"/></td>
				</center>
			</td>
		</tr>
	</table>
	<table align=center width=850px>
			<tr>
				<center>
				<td align=center>
					<span style="font-size:12px">Predicted performance (y-axis) of a classifier under different induced
						rarities (x-axis) for a labeling budget of 200 samples. Panels go from low behavior similarity (a) to high (d). 
						Our labeling method provides stable and better performance across a range of artificial rarities and at all levels of behavioral similarities. However, the method yields the largest benefit at higher rarities.</span>
				</td>
				</center>
			</tr>
		</table>
		<br>
		<table align=center width=850px>
			<center>
				<tr>
					<td>
						<b>Effect of labeled dataset size</b> - we found that the labeling effort had a small but significant positive effect on the performance of both methods.
						<br>
						<b>Effect of behavior similarity</b> Increased behavior similarity hurt the performance of both methods, but our method still dominated. 
						Mean AuPRCs dropped from 0.79 AuPRC to 0.40 in our method and for the random sampling from 0.59 to 0.28.
						<br>
						<b>Effect of behavior rarity</b> The effect of rarity level was stronger in the random method compared to our method. 
						When the behavior of interest becomes common, our method's performance becomes on par with random sampling. We believe the reason for this lies in the increased chance of finding
						rare instances that lie closer to the decision boundary of the classifier  (see Limitations section in our paper).
					</td>
				</tr>
			</center>
		</table>
		<center><h2>Biological datasets</h2></center>
		<table align=center width=800px>
			<tr>
				<td align=center width=800px>
					<center>
						<td><img class="round" style="width:800px" src="./resources/Fig6.png"/></td>
					</center>
				</td>
			</tr>
		</table>
		<table align=center width=850px>
				<tr>
					<center>
					<td align=center>
						<span style="font-size:12px">Predicted performance (y-axis) of a classifier under different induced
							rarities (x-axis) for a labeling budget of 200 samples. Each panel represents a different dataset. 
							Trends differ between datasets, however, our method provides a clear advantage in two datasets (b,c) across most of the rarity range.
						</span>
					</td>
					</center>
				</tr>
			</table>
			<table align=center width=850px>
				<center>
					<tr>
						<td>
							<b>Effect of labeled dataset size</b> - As above, labeling effort had a small but significant effect on performance which varied between datasets. 
							For PoseR and Meerkat performance stabilized after ~100 clips, while for FishLarvae1 review of 300 clips was necessary. 
							Note that perfomance is still not on par with a fully supervised baseline, but we achieve decent results for a much smaller annotation effort.
							<br>
							<b>Effect of behavior rarity</b> The effect of rarity was similarly mixed between datasets. 
							In PoseR and Meerkat perfomance gain was larger at higher rarities, as in the synthetic dataset, while in FishLarvae it was negatively correlated.
							See our paper for a more detailed discussion.
							<br>
							<br>
							Biological datasets are, predictably, much more challenging. 
							This performance gap may be attributed to mislabeled samples, noisy samples, or higher variance typical of natural behavior. 
							Our method truly shines when the rare behavior frequency is ≤ 1% of the dataset, 
							enabling the user to train rare behavior classifiers that yield a substantial advantage compared to traditional random sampling.
						</td>
					</tr>
				</center>
			</table>
	</div>
	<br>
	<hr>
<div id="Paper">
	<table align=center width=450px>
		<center><h1>Paper and Supplementary Material</h1></center>
		<tr>
		<td><a href=""><img class="layered-paper-big" style="height:175px" src="./resources/paper.png"/></a></td>
			<td><span style="font-size:14pt">Our paper was accepted to WACV 2025! For now the camera-ready version can be found on
				<a href="https://doi.org/10.48550/arXiv.2412.03452">arxiv</a>, and the code can be found on our <a href="https://github.com/shir3bar/SiftingTheHaystack">GitHub repo</a>.
				</span>
			</td>

		</tr>
	</table>
	</div>
	<br>


	<!--<table align=center width=600px>
		<tr>
			<td><span style="font-size:14pt"><center>
				<a href="./resources/bibtex.txt">[Bibtex]</a>
			</center></span></td>
		</tr>
	</table>-->
	<hr>
	<br>

	<table align=center width=450px>
		<center>
			<tr>
			<td width=400px>

					<center><h1>Questions?</h1></center>
					We'd love to hear them! Feel free to contact the corresponding author at <a href="mailto:shirbar@tauex.tau.ac.il">shirbar@tauex.tau.ac.il</a>

			</td>
		</tr>
		</center>
	</table>

<br>
	<hr>
	<br>

	<table align=center width=900px>
		<tr>
			<td width=400px>
				<left>
					<center><h1>Acknowledgements</h1></center>
					This template was originally made by <a href="http://web.mit.edu/phillipi/">Phillip Isola</a> and <a href="http://richzhang.github.io/">Richard Zhang</a> for a <a href="http://richzhang.github.io/colorization/">colorful</a> ECCV project; the code can be found <a href="https://github.com/richzhang/webpage-template">here</a>.
				</left>
			</td>
		</tr>
	</table>

<br>
</body>
</html>

